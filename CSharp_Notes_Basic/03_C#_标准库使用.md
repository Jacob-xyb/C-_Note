# Console

`using System;`

**Console.GetKey()** ：获取一个字符

**Console.GetKey(bool)** : 重载，参数为 ture 表示不在控制台显示输入的字符。

# OpenFileDialog

`using Microsoft.Win32;`

如果是控制台应用，主函数前需要添加属性：`[STAThread]`

```c#
[STAThread]
static void Main(string[] args)
{
    OpenFileDialog dlg = new OpenFileDialog();            
    Console.ReadKey();
}
```

## [STAThread]

`[STAThread]`: Single Thread Apartment Thread.（单一线程单元线程）

简单点说，如果用的是 **.NET Framework**，并且没有使用 **COM Interop**，一般不需要这个 Attribute。

其他的还有 MTA（多线程套间）、Free Thread（自由线程）。

## 属性

| OpenFileDialog基本属性 |                                                              |
| ---------------------- | ------------------------------------------------------------ |
| AddExtension           | 控制是否将扩展名自动添加到文件名上                           |
| CheckFileExists        | 指示用户指定不存在的文件时是否显示警告                       |
| CheckPathExists        | 在从对话框返回之前，检查指定的路径是否存在                   |
| DefaultExt             | 默认的扩展名，当用户键入文件名时，如果未指定扩展名，将在文件名后添加此扩展名 |
| DereferenceLinks       | 控制在从对话框返回之前是否取消引用快捷方式                   |
| **FileName**           | 第一个对话框中显示的文件，或用户选择的最后一个文件           |
| Filter                 | 对话框中显示的文件筛选器，例如"C#文件\|*.cs\|所有文件\|*.*"  |
| FilterIndex            | 对话框中选定的文件筛选器。第一项的索引为1                    |
| **InitialDirectory**   | 对话框的初始目录                                             |
| **Multiselect**        | 控制是否可以在该对话框中选择多个文件                         |
| RestoreDirectory       | 控制对话框在关闭之前是否恢复当前目录                         |
| ShowHelp               | 启用帮助按钮                                                 |
| **Title**              | 将显示在对话框标题栏中的字符串，默认是“打开”。               |
| ValidateNames          | 控制对话框是否确保文件名中不包含无效的字符或序列             |
| OpenFileDialog事件     |                                                              |
| FileOk                 | 当用户对话框单击"打开"或"保存"按钮是发生                     |
| HelpRequest            | 用户单击"帮助"按钮时发生                                     |

## 返回属性

| 名称          | 值                                        | 类型     |
| ------------- | ----------------------------------------- | -------- |
| FileName      | "D:\\...\\DynamicDataDisplay.License.txt" | string   |
| FileNames     | {string[2]}                               | string[] |
| SafeFileName  | "DynamicDataDisplay.License.txt"          | string   |
| SafeFileNames | {string[2]}                               | string[] |

# StringBuilder

`using System.Text`

```c#
public static void TestFunc_StringBuilder()
{
    // StringBuilder 没有一直在开辟空间，所以对字符串频繁操作时，应该用 StringBuilder
    StringBuilder tmp = new StringBuilder();
    string str = null;
    Stopwatch sw = new Stopwatch();
    sw.Start();
    for (int i = 0; i < 100000; i++)
    {
        str += i;
    }
    sw.Stop();
    Console.WriteLine(sw.Elapsed);  // 00:00:10.5140174

    sw.Restart();
    for (int i = 0; i < 100000; i++)
    {
        tmp.Append(i);
    }
    sw.Stop();
    Console.WriteLine(sw.Elapsed);  // 00:00:00.0096750
}
```

# AppDomain

`using System;`

# XmlSerializer

`using System.Xml.Serialization;`

# CallerMemberName

`using System.Runtime.CompilerServices;`

# Stopwatch

`using System.Diagnostics;`

计时器

